<launch>
    <!-- Name of the map to use and initial position -->
    <arg name="world_file"     default="$(find second_project)/stage/map.world"/>
    <arg name="initial_pose_x" default="2.0"/>
    <arg name="initial_pose_y" default="2.0"/>
    <arg name="initial_pose_a" default="0.0"/>

    <arg name="odom_frame_id"   default="odom"/>
    <arg name="global_frame_id" default="map"/>

    <param name="/use_sim_time" value="true"/>


    <!--  ***************** Robot simulation *****************  -->
    <node pkg="stage_ros" type="stageros" name="stageros" args="$(arg world_file)">
        <param name="base_watchdog_timeout" value="0.5"/>
        <remap from="base_scan" to="scan"/>
    </node>


    <!--  ************** Navigation  ***************  -->
    <node pkg="move_base" type="move_base" respawn="false" name="move_base" output="screen">

        <param name="base_global_planner" value="global_planner/GlobalPlanner" />  <!--   planner  navfn/NavfnROS alternative  carrot_planner/CarrotPlanner -->
        <param name="planner_frequency" value="1.0" />
        <param name="planner_patience" value="5.0" />
        <param name="use_dijkstra" value="false" />

        <!--param name="base_local_planner" value="dwa_local_planner/DWAPlannerROS" /-->
        <param name="base_local_planner" value="teb_local_planner/TebLocalPlannerROS" />
        <param name="controller_frequency" value="5.0" />
        <param name="controller_patience" value="5.0" /> <!-- How long the controller will wait in seconds without receiving a valid control before space-clearing operations are performed.  -->

        <param name="clearing_rotation_allowed" value="true"/>
    </node>


    <!--  ****** Goals *****  -->
    <node name="navigation" pkg="second_project" type="navigation"/>

    <!--  ****** amcl *****  -->
    <include file="$(find second_project)/launch/amcl.launch">
        <arg name="scan_topic" value="scan"/>
        <arg name="use_map_topic" value="true"/>
        <arg name="initial_pose_x" value="$(arg initial_pose_x)"/>
        <arg name="initial_pose_y" value="$(arg initial_pose_y)"/>
        <arg name="initial_pose_a" value="$(arg initial_pose_a)"/>
    </include>


</launch>
